<!DOCTYPE html>
<html>

<head>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-115491079-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115491079-1');
</script>

    <title>CNN based face detector from dlib</title>
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:site" content="arunponnusamy.com"/>
    <meta name="twitter:creator" content="@ponnusamy_arun"/>
    <meta name="twitter:image:src" content="http://www.arunponnusamy.com/images/cnn-face-detector-dlib/cnn-face-detection.png"/>

    <meta charset="utf-8"/>
    <meta property="og:title" content="CNN based face detector from dlib">
    <meta property="og:image" content="images/cnn-face-detector-dlib/cnn-face-detection.png">
    <meta property="og:description" content="Exploring the CNN based face detector that comes with dlib. ">
    <meta property="og:url" content="arunponnusamy.com">

    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="main.css">
    
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">
</head>

<body>

<header>
    <div class="container">
        <div class="row">
            <h2 class="col-sm-6 text-left">
            <a href="index.html">Arun Ponnusamy</a></h2>
            <nav class="col-sm-6 text-right">
            <h3>
            <a href="index.html">Home</a></h3>
            <h3>
            <a href="about.html">About</a></h3>
            <h3>
            <a href="ArunPonnusamy-CV.pdf">CV</a></h3>
            <h3>
            <a href="contact.html">Contact</a></h3>            
            </nav>
        </div>
    </div>
</header>

<section>
    <div>
        <h1 class="col-sm-offset-2 col-sm-8 col-sm-offset-2">CNN based face detector from dlib</h1>
	<p id="author" class="col-sm-offset-2 col-sm-8 col-sm-offset-2">15 Apr 2018 Arun Ponnusamy<p>
        <img class="col-sm-offset-2 col-sm-8 col-sm-offset-2" src="images/cnn-face-detector-dlib/cnn-face-detection.png"/>
        <p class="col-sm-offset-2 col-sm-8 col-sm-offset-2" id="source">Image Source: Google Images</p>
	
	<p></p>
	<p class="col-sm-offset-2 col-sm-8 col-sm-offset-2">If you are into any sort of image processing, computer vision or machine learning, chances are high that you might have come across/used dlib somewhere in your journey.</p>

	<p class="col-sm-offset-2 col-sm-8 col-sm-offset-2">According to dlib’s <a href="https://github.com/davisking/dlib">github page</a>, <i>dlib is a toolkit for making real world machine learning and data analysis applications in C++.</i> While the library is originally written in C++, it has good, easy to use Python bindings.</p>

	<p class="col-sm-offset-2 col-sm-8 col-sm-offset-2">I have majorly used dlib for <b>face detection</b> and <b>facial landmark detection</b>. The frontal face detector in dlib works really well. It is simple and just works out of the box.</p>
		
	<p class="col-sm-offset-2 col-sm-8 col-sm-offset-2">This detector is based on <i>histogram of oriented gradients (HOG)</i> and <i>linear SVM</i>. (Explaining how this detector works is beyond the scope of this blog post. Probably a topic to discuss for another day)</p>
	
<p class="col-sm-offset-2 col-sm-8 col-sm-offset-2">While the HOG+SVM based face detector has been around for a while and has gathered a good amount of users, I am not sure how many of us noticed the CNN based face detector available in dlib. Honestly, I didn’t. I accidentally came across it while browsing through dlib’s github repository.</p>

<p class="col-sm-offset-2 col-sm-8 col-sm-offset-2">My immediate thoughts were like,</p>

<p class="col-sm-offset-2 col-sm-8 col-sm-offset-2"><b>“Wow. Is it better than the existing detector ? How accurate it is ? Can it detect the face in all angles ? Can it run on real-time video ?”</b></p>

<p class="col-sm-offset-2 col-sm-8 col-sm-offset-2">Well, that’s what this post is all about. Trying to find out the answers for the above questions.</p>

	<p class="col-sm-offset-3 col-sm-6 col-sm-offset-3 text-center">.    .    .</p>
		     
	<p class="col-sm-offset-2 col-sm-8 col-sm-offset-2">If you have ever used the HOG based face detector in dlib, you probably know that it will not detect faces at odd angles. It is meant to be a good <i>"frontal"</i> face detector and it is, indeed.</p>

<p class="col-sm-offset-2 col-sm-8 col-sm-offset-2">It detects faces even when they are not perfectly frontal to a good extend. Which is really good for a frontal face detector. But you can only expect so much from it.</p>

<p class="col-sm-offset-2 col-sm-8 col-sm-offset-2">Meanwhile, the CNN based detector is capable of detecting faces almost in all angles. Unfortunately it is not suitable for real time video. It is meant to be executed on a GPU. To get the same speed as the HOG based detector you might need to run on a powerful Nvidia GPU.</p>

<p class="col-sm-offset-2 col-sm-8 col-sm-offset-2">Nevertheless, this should not stop us from trying it on images.</p>

<p class="col-sm-offset-2 col-sm-8 col-sm-offset-2">In the remainder of this post, I am going to show you how you can use the CNN based face detector from dlib on images and compare the results with HOG based detector with ready to use Python code.</p>

<p class="col-sm-offset-2 col-sm-8 col-sm-offset-2">Let’s jump right in and start coding.</p>

<div class="col-sm-offset-2 col-sm-8 col-sm-offset-2">
<script src="https://gist.github.com/arunponnusamy/2387d11c0a2995a5e428eb425835a2dc.js"></script></div>

<p class="col-sm-offset-2 col-sm-8 col-sm-offset-2">Let’s start by importing the necessary packages. If you have not installed these packages, you can install them by typing the below command in the Terminal.</p>

<code class="col-sm-offset-2 col-sm-8 col-sm-offset-2">pip install opencv-python dlib argparse time</code>

<p class="col-sm-offset-2 col-sm-8 col-sm-offset-2">(argparse and time are more likely to come pre-installed with Python)</p>

<p class="col-sm-offset-2 col-sm-8 col-sm-offset-2">If you are not using virtual environment for Python, I highly recommend to start using it. You can checkout my previous <a href="http://www.arunponnusamy.com/deep-learning-setup-macos.html">post</a> if you need a starting point.</p>


   </div>

</section>

<div id="disqus_thread" class="col-sm-offset-2 col-sm-8 col-sm-offset-2"></div>
<script class="col-sm-offset-2 col-sm-8 col-sm-offset-2">

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = 'http://arunponnusamy.com/cnn-face-detector-dlib.html';  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = 'cnn-face-detector-dlib'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://arunponnusamy.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                            

<footer class="col-sm-offset-2 col-sm-8 col-sm-offset-2">
    <div class="row">
        <p class="col-sm-4">&copy; 2018 Arun Ponnusamy</p>
        <ul class="col-sm-8">
            <li class="col-sm-1"><a href="https://github.com/arunponnusamy"><img src="https://image.flaticon.com/icons/png/512/25/25231.png"></a></li>  
            <li class="col-sm-1"><a href="https://twitter.com/ponnusamy_arun"><img src="https://www.w3.org/2008/site/images/Twitter_bird_logo_2012.svg"></a></li>  
            <li class="col-sm-1"><a href="https://www.linkedin.com/in/arun-ponnusamy/"><img src="https://norfipc.com/img/logos/logotipo-oficial-linkedin-2014.png"></a></li>
            <li class="col-sm-1"><a href="https://www.quora.com/profile/Arun-Ponnusamy-2"><img src="http://cdn.embed.ly/providers/logos/quora.png"></a></li>
            <li class="col-sm-1" id="medium"><a href="https://medium.com/@arunponnusamy"><img src="https://upload.wikimedia.org/wikipedia/en/9/90/Medium_%28publishing_platform%29_Logo_2015.png"></a></li>  
    </div>
</footer>

</body>

</html>
